<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="WEBCRAWLER_PAGE">
	<typeAlias alias="Page" type="com.blackleaf.webcrawler.domain.Page" />
	<insert id="insertPage" parameterClass="Page">
		insert into page (type, url, content, link_id) values (#type#, #url#, #content#, #linkId#)
		<selectKey resultClass="long" keyProperty="id">
			SELECT LAST_INSERT_ID();
		</selectKey>
	</insert>
	<insert id="insertPages" parameterClass="java.util.List">
		insert into page (type, url, content, link_id) values
		<iterate conjunction=",">
			(#values[].type#, #values[].url#, #values[].content#, #values[].linkId#)
        </iterate>
		<selectKey resultClass="long" keyProperty="id">
			SELECT LAST_INSERT_ID();
		</selectKey>
	</insert>
	
	<select id="getPagesByType" parameterClass="java.util.Map" resultClass="Page">
		select * from page where type=#type# and status=0 limit $maxSize$
	</select>
	<select id="getPageByLinkId" parameterClass="long" resultClass="Page">
		select * from page where link_id=#value#
	</select>
</sqlMap>